<?xml version="1.0" encoding="UTF-8"?>
<svg width="1400" height="1000" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .actor-box { fill: #E0F2FE; stroke: #0369A1; stroke-width: 2; }
      .lifeline { stroke: #64748B; stroke-width: 2; stroke-dasharray: 5,5; }
      .message-arrow { stroke: #1E40AF; stroke-width: 2; marker-end: url(#arrowhead); }
      .return-arrow { stroke: #059669; stroke-width: 2; marker-end: url(#arrowhead); stroke-dasharray: 3,3; }
      .activation { fill: #FEF3C7; stroke: #D97706; stroke-width: 1; }
      .note { fill: #F3F4F6; stroke: #6B7280; stroke-width: 1; }
      .title { font-family: Arial, sans-serif; font-size: 18px; font-weight: bold; fill: #1E293B; }
      .actor-text { font-family: Arial, sans-serif; font-size: 12px; font-weight: bold; fill: #1E40AF; }
      .message-text { font-family: Arial, sans-serif; font-size: 11px; fill: #1E293B; }
      .note-text { font-family: Arial, sans-serif; font-size: 10px; fill: #374151; }
    </style>
    
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#1E40AF"/>
    </marker>
    
    <marker id="return-arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#059669"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="1400" height="1000" fill="#FEFEFE"/>
  
  <!-- Title -->
  <text x="700" y="30" text-anchor="middle" class="title">Diagrama de Sequência - Sistema DentalSpa</text>
  <text x="700" y="50" text-anchor="middle" class="note-text">Fluxo: Agendamento de Consulta com Cadastro de Novo Paciente</text>
  
  <!-- Actors/Objects -->
  <!-- Usuario -->
  <rect x="50" y="80" width="100" height="40" class="actor-box" rx="5"/>
  <text x="100" y="105" text-anchor="middle" class="actor-text">Usuário</text>
  
  <!-- Angular Frontend -->
  <rect x="200" y="80" width="120" height="40" class="actor-box" rx="5"/>
  <text x="260" y="105" text-anchor="middle" class="actor-text">Angular Frontend</text>
  
  <!-- Auth Service -->
  <rect x="370" y="80" width="100" height="40" class="actor-box" rx="5"/>
  <text x="420" y="105" text-anchor="middle" class="actor-text">Auth Service</text>
  
  <!-- Express API -->
  <rect x="520" y="80" width="100" height="40" class="actor-box" rx="5"/>
  <text x="570" y="105" text-anchor="middle" class="actor-text">Express API</text>
  
  <!-- Patient Service -->
  <rect x="670" y="80" width="110" height="40" class="actor-box" rx="5"/>
  <text x="725" y="105" text-anchor="middle" class="actor-text">Patient Service</text>
  
  <!-- Appointment Service -->
  <rect x="830" y="80" width="120" height="40" class="actor-box" rx="5"/>
  <text x="890" y="105" text-anchor="middle" class="actor-text">Appointment Service</text>
  
  <!-- Drizzle ORM -->
  <rect x="1000" y="80" width="100" height="40" class="actor-box" rx="5"/>
  <text x="1050" y="105" text-anchor="middle" class="actor-text">Drizzle ORM</text>
  
  <!-- PostgreSQL -->
  <rect x="1150" y="80" width="100" height="40" class="actor-box" rx="5"/>
  <text x="1200" y="105" text-anchor="middle" class="actor-text">PostgreSQL</text>
  
  <!-- Lifelines -->
  <line x1="100" y1="120" x2="100" y2="950" class="lifeline"/>
  <line x1="260" y1="120" x2="260" y2="950" class="lifeline"/>
  <line x1="420" y1="120" x2="420" y2="950" class="lifeline"/>
  <line x1="570" y1="120" x2="570" y2="950" class="lifeline"/>
  <line x1="725" y1="120" x2="725" y2="950" class="lifeline"/>
  <line x1="890" y1="120" x2="890" y2="950" class="lifeline"/>
  <line x1="1050" y1="120" x2="1050" y2="950" class="lifeline"/>
  <line x1="1200" y1="120" x2="1200" y2="950" class="lifeline"/>
  
  <!-- Sequence Messages -->
  
  <!-- 1. Login -->
  <line x1="100" y1="160" x2="260" y2="160" class="message-arrow"/>
  <text x="180" y="155" class="message-text">1. login(email, password)</text>
  
  <rect x="255" y="165" width="10" height="25" class="activation"/>
  
  <line x1="260" y1="180" x2="420" y2="180" class="message-arrow"/>
  <text x="340" y="175" class="message-text">2. authenticate()</text>
  
  <rect x="415" y="185" width="10" height="25" class="activation"/>
  
  <line x1="420" y1="200" x2="570" y2="200" class="message-arrow"/>
  <text x="495" y="195" class="message-text">3. POST /api/login</text>
  
  <rect x="565" y="205" width="10" height="25" class="activation"/>
  
  <!-- Return JWT -->
  <line x1="570" y1="220" x2="420" y2="220" class="return-arrow" marker-end="url(#return-arrowhead)"/>
  <text x="495" y="235" class="message-text">4. return JWT token</text>
  
  <line x1="420" y1="240" x2="260" y2="240" class="return-arrow" marker-end="url(#return-arrowhead)"/>
  <text x="340" y="255" class="message-text">5. token stored</text>
  
  <line x1="260" y1="260" x2="100" y2="260" class="return-arrow" marker-end="url(#return-arrowhead)"/>
  <text x="180" y="275" class="message-text">6. redirect to dashboard</text>
  
  <!-- 2. Acessar Agenda -->
  <line x1="100" y1="300" x2="260" y2="300" class="message-arrow"/>
  <text x="180" y="295" class="message-text">7. acessar agenda</text>
  
  <rect x="255" y="305" width="10" height="25" class="activation"/>
  
  <line x1="260" y1="320" x2="570" y2="320" class="message-arrow"/>
  <text x="415" y="315" class="message-text">8. GET /api/appointments</text>
  
  <rect x="565" y="325" width="10" height="45" class="activation"/>
  
  <line x1="570" y1="340" x2="1050" y2="340" class="message-arrow"/>
  <text x="810" y="335" class="message-text">9. select appointments</text>
  
  <rect x="1045" y="345" width="10" height="25" class="activation"/>
  
  <line x1="1050" y1="355" x2="1200" y2="355" class="message-arrow"/>
  <text x="1125" y="350" class="message-text">10. SQL query</text>
  
  <line x1="1200" y1="370" x2="1050" y2="370" class="return-arrow" marker-end="url(#return-arrowhead)"/>
  <text x="1125" y="385" class="message-text">11. appointments data</text>
  
  <line x1="1050" y1="390" x2="570" y2="390" class="return-arrow" marker-end="url(#return-arrowhead)"/>
  <text x="810" y="405" class="message-text">12. return appointments[]</text>
  
  <line x1="570" y1="410" x2="260" y2="410" class="return-arrow" marker-end="url(#return-arrowhead)"/>
  <text x="415" y="425" class="message-text">13. appointments list</text>
  
  <!-- 3. Novo Agendamento -->
  <line x1="100" y1="450" x2="260" y2="450" class="message-arrow"/>
  <text x="180" y="445" class="message-text">14. novo agendamento</text>
  
  <rect x="255" y="455" width="10" height="25" class="activation"/>
  
  <line x1="260" y1="470" x2="570" y2="470" class="message-arrow"/>
  <text x="415" y="465" class="message-text">15. GET /api/clients</text>
  
  <rect x="565" y="475" width="10" height="25" class="activation"/>
  
  <line x1="570" y1="490" x2="260" y2="490" class="return-arrow" marker-end="url(#return-arrowhead)"/>
  <text x="415" y="505" class="message-text">16. patients list</text>
  
  <!-- 4. Adicionar Novo Paciente -->
  <line x1="100" y1="530" x2="260" y2="530" class="message-arrow"/>
  <text x="180" y="525" class="message-text">17. clicar botão "+"</text>
  
  <rect x="255" y="535" width="10" height="15" class="activation"/>
  
  <rect x="60" y="560" width="140" height="30" class="note"/>
  <text x="130" y="578" text-anchor="middle" class="note-text">Modal "Novo Paciente" aberto</text>
  
  <line x1="100" y1="600" x2="260" y2="600" class="message-arrow"/>
  <text x="150" y="595" class="message-text">18. preencher dados</text>
  <text x="150" y="610" class="message-text">    (nome, email, telefone, etc.)</text>
  
  <line x1="100" y1="630" x2="260" y2="630" class="message-arrow"/>
  <text x="180" y="625" class="message-text">19. salvar paciente</text>
  
  <rect x="255" y="635" width="10" height="25" class="activation"/>
  
  <line x1="260" y1="650" x2="725" y2="650" class="message-arrow"/>
  <text x="492" y="645" class="message-text">20. createPatient(patientData)</text>
  
  <rect x="720" y="655" width="10" height="45" class="activation"/>
  
  <line x1="725" y1="670" x2="570" y2="670" class="message-arrow"/>
  <text x="647" y="665" class="message-text">21. POST /api/clients</text>
  
  <rect x="565" y="675" width="10" height="25" class="activation"/>
  
  <line x1="570" y1="690" x2="1050" y2="690" class="message-arrow"/>
  <text x="810" y="685" class="message-text">22. insert into clients</text>
  
  <rect x="1045" y="695" width="10" height="25" class="activation"/>
  
  <line x1="1050" y1="705" x2="1200" y2="705" class="message-arrow"/>
  <text x="1125" y="700" class="message-text">23. INSERT SQL</text>
  
  <line x1="1200" y1="720" x2="1050" y2="720" class="return-arrow" marker-end="url(#return-arrowhead)"/>
  <text x="1125" y="735" class="message-text">24. new patient ID</text>
  
  <line x1="1050" y1="740" x2="570" y2="740" class="return-arrow" marker-end="url(#return-arrowhead)"/>
  <text x="810" y="755" class="message-text">25. patient created</text>
  
  <line x1="570" y1="760" x2="725" y2="760" class="return-arrow" marker-end="url(#return-arrowhead)"/>
  <text x="647" y="775" class="message-text">26. return new patient</text>
  
  <line x1="725" y1="780" x2="260" y2="780" class="return-arrow" marker-end="url(#return-arrowhead)"/>
  <text x="492" y="795" class="message-text">27. patient added to list</text>
  
  <rect x="60" y="810" width="140" height="30" class="note"/>
  <text x="130" y="828" text-anchor="middle" class="note-text">Paciente automaticamente</text>
  <text x="130" y="838" text-anchor="middle" class="note-text">selecionado no dropdown</text>
  
  <!-- 5. Finalizar Agendamento -->
  <line x1="100" y1="860" x2="260" y2="860" class="message-arrow"/>
  <text x="150" y="855" class="message-text">28. finalizar agendamento</text>
  <text x="150" y="870" class="message-text">    (serviço, data, hora)</text>
  
  <rect x="255" y="875" width="10" height="25" class="activation"/>
  
  <line x1="260" y1="890" x2="890" y2="890" class="message-arrow"/>
  <text x="575" y="885" class="message-text">29. createAppointment(appointmentData)</text>
  
  <rect x="885" y="895" width="10" height="25" class="activation"/>
  
  <line x1="890" y1="905" x2="570" y2="905" class="message-arrow"/>
  <text x="730" y="900" class="message-text">30. POST /api/appointments</text>
  
  <line x1="570" y1="920" x2="260" y2="920" class="return-arrow" marker-end="url(#return-arrowhead)"/>
  <text x="415" y="935" class="message-text">31. agendamento criado</text>
  
  <line x1="260" y1="940" x2="100" y2="940" class="return-arrow" marker-end="url(#return-arrowhead)"/>
  <text x="180" y="955" class="message-text">32. sucesso - agenda atualizada</text>
  
  <!-- Legend -->
  <rect x="1250" y="200" width="140" height="120" class="note"/>
  <text x="1320" y="220" text-anchor="middle" class="actor-text">Legenda</text>
  
  <line x1="1260" y1="240" x2="1290" y2="240" class="message-arrow"/>
  <text x="1300" y="245" class="note-text">Chamada síncrona</text>
  
  <line x1="1260" y1="260" x2="1290" y2="260" class="return-arrow" marker-end="url(#return-arrowhead)"/>
  <text x="1300" y="265" class="note-text">Retorno</text>
  
  <rect x="1260" y="275" width="10" height="15" class="activation"/>
  <text x="1280" y="287" class="note-text">Ativação</text>
  
  <rect x="1260" y="300" width="50" height="15" class="note"/>
  <text x="1295" y="310" class="note-text">Nota</text>
  
  <!-- Key Features Box -->
  <rect x="50" y="980" width="600" height="15" class="note"/>
  <text x="350" y="992" text-anchor="middle" class="note-text">Principais características: JWT Authentication, Modal de Cadastro Integrado, Auto-seleção de Paciente, Validação em Tempo Real</text>
</svg>