CREATE TABLE Appointment (
    Id INT IDENTITY(1,1) PRIMARY KEY,
    PatientId INT NOT NULL,
    StaffId INT NOT NULL,
    ServiceId INT NOT NULL,
    ClinicId INT NOT NULL,
    StartTime DATETIME2 NOT NULL,
    EndTime DATETIME2 NOT NULL,
    Status NVARCHAR(50) NOT NULL,
    Notes NVARCHAR(1000) NULL,
    Room NVARCHAR(100) NULL,
    Price DECIMAL(18,2) NOT NULL,
    PaymentStatus NVARCHAR(50) NULL,
    PaymentMethod NVARCHAR(50) NULL,
    IsRecurring BIT NOT NULL DEFAULT 0,
    RecurrencePattern NVARCHAR(100) NULL,
    RecurrenceEndDate DATETIME2 NULL,
    ParentAppointmentId INT NULL,
    CancellationReason NVARCHAR(500) NULL,
    CancelledAt DATETIME2 NULL,
    ConfirmedAt DATETIME2 NULL,
    CompletedAt DATETIME2 NULL,
    ClientFeedback NVARCHAR(1000) NULL,
    Rating INT NULL,
    CreatedAt DATETIME2 NOT NULL DEFAULT GETUTCDATE(),
    UpdatedAt DATETIME2 NULL,
    CreatedByUserId INT NULL,
    UpdatedByUserId INT NULL,
    FOREIGN KEY (PatientId) REFERENCES Patient(Id) ON DELETE RESTRICT,
    FOREIGN KEY (StaffId) REFERENCES Staff(Id) ON DELETE RESTRICT,
    FOREIGN KEY (ServiceId) REFERENCES Service(Id) ON DELETE RESTRICT,
    FOREIGN KEY (ClinicId) REFERENCES ClinicInfo(Id) ON DELETE RESTRICT,
    FOREIGN KEY (ParentAppointmentId) REFERENCES Appointment(Id) ON DELETE RESTRICT,
    FOREIGN KEY (CreatedByUserId) REFERENCES [User](Id),
    FOREIGN KEY (UpdatedByUserId) REFERENCES [User](Id)
); 